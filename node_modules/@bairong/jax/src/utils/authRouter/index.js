import _ from 'lodash';

const authRouter = {
  setRouters: function (tree = []) {
    // 取按钮，正确填写的
    let authNames = _.chain(tree).filter((item) => +item.category === 3).map('englishName').value();
    // 按钮权限名称
    authRouter.authNames = authNames;
    // 路由名称
    authRouter.authPaths = _.map(tree, 'url');
  },
  hasAuth: function (to) {
    let authPaths = authRouter.authPaths || [];
    let routerPath = to.path;
    let pathArr = to.path.split('/').filter(item => item !== '');
    let isPath = false;
    pathArr.map(path => {
      if (authPaths.indexOf(routerPath) > -1 || authPaths.indexOf(path) > -1 || authPaths.indexOf('/' + path) > -1) {
        isPath = true;
      }
    });

    authRouter.currentName = to.name;
    return authPaths.indexOf(to.name) > -1 || isPath;
  }
};

export default authRouter;

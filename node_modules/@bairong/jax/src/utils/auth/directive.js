import _ from 'lodash';
import auth from './auth';

const authDirective = {
  authTree: auth.getAuth() || [],
  setAuthTree: function (datas = []) {
    let englishNameFilter = datas.filter(item => item.englishName !== '' && item.englishName !== 'englishName') || [];
    let trees = _.map(englishNameFilter, 'englishName');
    this.authTree = trees;
  },
  install: function (Vue, options) {
    Vue.directive('br-auth', {
      inserted: (el, binding, vnode) => {
        if (!this.authTree.some(val => val === binding.value)) {
          el.parentNode.removeChild(el);
        }
      }
    });
  }
};

export default authDirective;

<template>
  <transition name='breadcrump'>
    <Breadcrumb :separator='separator' class='p-breadcrump'>
      <Icon custom="br-icon br-icon-home " size="20" style="margin-right: 5px"></Icon>
      <BreadcrumbItem v-for='item in dataList' :to='item.path' :key='item.path' >{{renderTitle(item)}}</BreadcrumbItem>
      <!-- <BreadcrumbItem to='' key='' ></BreadcrumbItem>   -->
    </Breadcrumb>
  </transition>
</template>

<script>
export default {
  name: 'PBreadcrumb',
  props: {
    separator: {
      type: String,
      default: '/'
    }
  },
  created () {
    this.getBreadData();
  },
  data () {
    return {
      dataList: []
    };
  },
  watch: {
    $route () {
      this.getBreadData();
    }
  },
  computed: {
  },
  methods: {
    renderTitle (data) {
      return data.meta && data.meta.title ? data.meta.title : '';
    },
    getBreadData () {
      const rMatcheds = this.$route.matched.filter(item => (item.path || item.name || item.meta.disabled) && item.meta.title);
      let arr = [...rMatcheds];
      if (!arr || !arr.length) {
        arr = [{ path: '/', name: '/', meta: { title: '/' } }].concat(arr);
      }
      const len = arr.length;
      const newArr = arr.map((item, i) => {
        const disabled = item.meta && item.meta.disabled;
        item.path = disabled ? '' : i === (len - 1) ? this.$route.fullPath : item.path;
        return item;
      });
      this.dataList = [...newArr];
    }
  }
};
</script>

<style scoped>
  .p-breadcrump {
    padding: 12px 20px;
    font-size: 14px;
    border-bottom: 1px solid #F7F7F7;
  }

  .breadcrumb-enter,
  .breadcrumb-leave-active {
    opacity: 0;
    transform: translateX(20px);
  }

  .breadcrumb-move {
    transition: all .5s;
  }

  .breadcrumb-leave-active {
    position: absolute;
  }

</style>

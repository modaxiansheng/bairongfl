<template>
  <Dropdown placement="right-start" @on-click="handleMenuClick"  :class='dropdownClass'>
    <DropdownItem class="menu-hover" :name="data.name">
      <slot name='dropContent'></slot>
    </DropdownItem>
    <DropdownMenu slot="list">
      <template v-for="(item, index) in data.children">
        <DropdownItem v-if='!item.children || !item.children.length' :key="'dpchild' + index" :name="item.name">
          <NavIcon :data="item"></NavIcon>
          <span class="dropdown-menu-title">{{item.title}}</span>
        </DropdownItem>
        <PDropdownMenu v-else
          :key="'dpchildren' + index"
          :data="item"
          :theme="theme"
          :children-key="childrenKey"
          @on-select="handleMenuClick">
          <template slot="dropContent">
            <div class="dp-children">
              <NavIcon :data="item"></NavIcon>
              <span class="dropdown-menu-title">{{item.title}}</span>
              <Icon type="ios-arrow-right" class='dp-right-icon'></Icon>
            </div>
          </template>
        </PDropdownMenu>
      </template>
    </DropdownMenu>
  </Dropdown>
</template>

<script>
import NavIcon from './NavIcon';

export default {
  name: 'PDropdownMenu',
  components: {NavIcon},
  data () {
    return {};
  },
  props: {
    data: {
      type: [Object, Array]
    },
    theme: {
      type: String,
      default: 'dark'
    },
    childrenKey: {
      type: String,
      default: 'children'
    }
  },
  computed: {
    dropdownClass () {
      return `dropdown-theme dropdown-theme-${this.theme}`;
    }
  },
  methods: {
    handleMenuClick (name) {
      this.$emit('on-select', name);
    }
  }
};
</script>

<style lang="less" scoped>

</style>

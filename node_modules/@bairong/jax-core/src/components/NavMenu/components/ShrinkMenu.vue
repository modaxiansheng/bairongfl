<template>
  <div v-if="isChildren" :class="pdClass">
    <PDropdownMenu
      :data="data"
      :children-key="childrenKey"
      :theme="theme"
      @on-select="handleMenuClick">
      <div slot="dropContent" class="shrink-menu-root">
        <NavIcon :data="data"></NavIcon>
      </div>
    </PDropdownMenu>
  </div>
  <div v-else :class="pdClass">
    <Dropdown placement="right-start" @on-click="handleMenuClick" :class='dropdownClass'>
      <DropdownItem class="menu-hover" :name="data.name">
        <div class="shrink-menu-root">
          <NavIcon :data="data"></NavIcon>
        </div>
      </DropdownItem>
      <DropdownMenu slot="list">
        <DropdownItem :name="data.name">{{data.title}}</DropdownItem>
      </DropdownMenu>
    </Dropdown>
  </div>
</template>

<script>
import NavIcon from './NavIcon';
import PDropdownMenu from './PDropdownMenu';

export default {
  name: 'ShrinkMenu',
  components: {
    NavIcon, PDropdownMenu
  },
  data () {
    return {};
  },
  props: {
    data: {
      type: [Object, Array]
    },
    theme: {
      type: String,
      default: 'dark'
    },
    childrenKey: {
      type: String,
      default: 'children'
    }
  },
  computed: {
    pdClass () {
      return [
        'shrink-menu',
        'shrink-menu-' + this.theme
      ];
    },
    dropdownClass () {
      return `dropdown-theme-${this.theme}`;
    },
    isChildren () {
      return this.data[this.childrenKey] && this.data[this.childrenKey].length;
    }
  },
  methods: {
    handleMenuClick (name) {
      this.$emit('on-select', name);
    }
  }
};
</script>

<style lang="less" scoped>

</style>

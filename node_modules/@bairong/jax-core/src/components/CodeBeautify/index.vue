<template>
  <pre :class="className" v-html="htmlText"></pre>
</template>

<script>
import beautify from 'code-beautify';

export default {
  name: 'CodeBeautify',
  props: {
    lang: String,
    code: String,
    theme: {
      type: String,
      default () {
        return 'dark';
      }
    },
    transparent: Boolean
  },
  data () {
    return {
      htmlText: '',
      currentTheme: this.theme,
    };
  },
  computed: {
    className () {
      return [
        'code-pre',
        this.transparent ? 'pre--transparent' : '',
        'pre-' + this.currentTheme
      ];
    }
  },
  watch: {
    theme (th) {
      this.currentTheme = th;
    },
    code () {
      this.htmlText = beautify(this.code, this.lang || 'js');
    }
  },
  mounted () {
    this.htmlText = beautify(this.code, this.lang || 'js');
  }
};
</script>

<style lang="less">
@import './index.less';
</style>

{"remainingRequest":"E:\\bairongfl\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\bairongfl\\node_modules\\@bairong\\jax\\src\\components\\layout\\layout.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\bairongfl\\node_modules\\@bairong\\jax\\src\\components\\layout\\layout.vue","mtime":1591423012927},{"path":"E:\\bairongfl\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\bairongfl\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\bairongfl\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\bairongfl\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\bairongfl\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Cookies from 'js-cookie';\nimport _ from 'lodash';\nimport { http, resourceConf } from '../../utils/';\nimport { TopMenu, ShrinkableMenu, FullScreen, ThemeSwitch, PBreadcrumb } from '@bairong/jax-core';\nimport userMenu from './common/userMenu';\n\nexport default {\n  name: 'Layout',\n  components: {\n    ShrinkableMenu,\n    FullScreen,\n    ThemeSwitch,\n    TopMenu,\n    PBreadcrumb,\n    userMenu\n  },\n  props: {\n    isOpenDefautlMenu: {\n      type: Boolean,\n      default: true\n    },\n    headerTitle: {\n      type: String,\n      default: ''\n    },\n    showFullScreen: {\n      type: Boolean,\n      default: false\n    },\n    showThemeSwitch: {\n      type: Boolean,\n      default: false\n    },\n    changeTopMenu: {\n      type: Function\n    },\n    iconSize: {\n      Number,\n      default: 18\n    },\n    showSubIcon: {\n      type: Boolean,\n      default: true\n    },\n    separator: {\n      type: String\n    },\n    beadcrumbException: {\n      type: Array,\n      default: () => {\n        return ['/home', '/404'];\n      }\n    }\n  },\n  data () {\n    return {\n      shrink: !!+Cookies.set('isShrink'),\n      isFullScreen: false,\n      openedSubmenuArr: [],\n      activeName: '',\n      saveLoading: false,\n      resourceConf\n    };\n  },\n  computed: {\n    menuList () {\n      if ( this.isOpenDefautlMenu && this.$store.state.user.sideList.length) {\n        this.openDefaultMenu();\n      }\n      return this.$store.state.user.sideList;\n    },\n    toolbarList () {\n      return this.$store.state.user.toolbarList;\n    },\n    toolbarActiveName () {\n      const toolbarList = this.$store.state.user.toolbarList;\n      const activeMenu = toolbarList.filter(item => !!item.className) || [];\n      return activeMenu.length ? activeMenu[0].name : '';\n    },\n    /**\n     * 取得一级目录展开名称，\n     * return Array\n     * */\n    getOpenMenuNames () {\n      const names = _.map(this.$route.path.split('/')).filter(path => path !== '') || '';\n      return ['/' + names[0]] || this.openedSubmenuArr;\n    },\n    /**\n     * 取得当前二级菜单\n     * */\n    getActiveName () {\n      const parentPath = this.$route.meta.parentPath;\n      return parentPath || this.activeName || this.$route.path;\n    },\n    menuTheme () {\n      return this.$store.state.app.menuTheme;\n    },\n    isShowBeadcrumb () {\n      const { name, path } = this.$route;\n      return this.beadcrumbException.indexOf('/' + name) > -1 || this.beadcrumbException.indexOf(path) > -1;\n    },\n    isShowTitle () {\n      return this.headerTitle !== '';\n    },\n    isDark () {\n      return this.$store.state.app.menuTheme === 'dark';\n    }\n  },\n  methods: {\n    init () {\n      // let openMenuName = this.$route.name;\n      // this.openedSubmenuArr = [openMenuName];\n      //  let pathArr = regExp.setCurrentPath(this, this.$route.name);\n      //  this.$store.commit('updateMenulist');\n      //  if (pathArr.length >= 2) {\n      //    this.$store.commit('addOpenSubmenu', pathArr[1].name);\n      //  }\n      // this.userName = Cookies.get('user');\n    },\n    cookieExtend () {\n      return http.DOMAIN.includes('100credit.com') ? [{ path: '/', domain: '100credit.com' }] : [];\n    },\n    toggleClick () {\n      this.shrink = !this.shrink;\n      Cookies.set(...['isShrink', this.shrink ? 1 : 0].concat(this.cookieExtend()));\n    },\n    handleSubmenuChange (val) {\n      this.activeName = val;\n    },\n    fullscreenChange (isFullScreen) {\n    },\n    handleChangeTopMenu ({ id, url }) {\n      this.$router.push({ path: url });\n      this.$emit('on-changeTopMenu', id);\n      this.activeName = url;\n    },\n    /**\n     * 首次打开时，显示home，再刷新显示默认第一个菜单\n     * */\n    openDefaultMenu () {\n      let menuList = this.$store.state.user.sideList;\n      let defaultMenu = menuList[0].children && menuList[0].children.length ? menuList[0].children[0].path : menuList[0].path;\n      let hashName = this.$route.name;\n      let noOpenDefautlMenu = +Cookies.get('NOODM') || 0;\n      if (hashName === 'home' && !noOpenDefautlMenu) {\n        this.$router.push({ path: defaultMenu });\n      }\n      Cookies.remove(...['NOODM'].concat(this.cookieExtend()));\n    },\n    /**\n     * 手动设置展开一级目录,当前二级菜单\n     * @param data{}\n     * */\n    setOpenMenu (data) {\n      this.openedSubmenuArr = [data.openMenuName];\n      this.activeName = data.activeName;\n    }\n  },\n  mounted () {\n    this.init();\n  }\n};\n",{"version":3,"sources":["layout.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"layout.vue","sourceRoot":"node_modules/@bairong/jax/src/components/layout","sourcesContent":["<style lang=\"less\">\n  @import './styles/layout.less';\n</style>\n<template>\n  <div class=\"main\" :class=\"{'main-hide-text': shrink}\">\n    <div class=\"sidebar-menu-con\" :class=\"{dark: isDark}\" :style=\"{width: shrink?'60px':'200px'}\">\n      <shrinkable-menu\n        :shrink=\"shrink\"\n        :icon-size=\"iconSize\"\n        :showSubIcon=\"showSubIcon\"\n        @on-change=\"handleSubmenuChange\"\n        :theme=\"menuTheme\"\n        :open-names=\"getOpenMenuNames\"\n        :active-name=\"getActiveName\"\n        :menu-list=\"menuList\">\n        <div slot=\"top\" class=\"logo-con theme-main-color\">\n          <img v-show=\"!shrink\" :src=\"resourceConf.layoutLogoURL\" class=\"logo-big\" key=\"max-logo\"/>\n          <img v-show=\"shrink\" :src=\"resourceConf.layoutMinLogoURL\" class=\"logo-small\" key=\"min-logo\"/>\n        </div>\n      </shrinkable-menu>\n      <div class=\"navicon-con\">\n        <div :style=\"{transform: 'rotateZ(' + (this.shrink ? '-180' : '0') + 'deg)'}\" @click=\"toggleClick\">\n          <span v-if=\"!this.shrink\">收起</span><Icon custom=\"br-icon br-icon-shrink\" size=\"24\"></Icon>\n        </div>\n      </div>\n    </div>\n    <div class=\"main-header-con\" :style=\"{paddingLeft: shrink?'60px':'200px'}\">\n      <div class=\"main-header theme-main-color\">\n        <div v-if=\"isShowTitle\" class=\"header-title\">{{headerTitle}}</div>\n        <div class=\"header-middle-con\">\n          <top-menu class=\"theme-main-color\" v-if=\"toolbarList.length\" :toolbarList=\"toolbarList\" :activeName=\"toolbarActiveName\" @changeTopMenu=\"handleChangeTopMenu\"></top-menu>\n        </div>\n        <div class=\"header-avator-con\">\n          <full-screen v-if=\"showFullScreen\" v-model=\"isFullScreen\" @on-change=\"fullscreenChange\"></full-screen>\n          <theme-switch v-if=\"showThemeSwitch\"></theme-switch>\n          <slot name=\"userContent\">\n            <user-menu></user-menu>\n          </slot>\n        </div>\n      </div>\n    </div>\n    <div class=\"single-page-con\" :style=\"{left: shrink?'60px':'200px'}\">\n      <div class=\"single-page\">\n        <P-breadcrumb v-if=\"!isShowBeadcrumb\" :separator=\"separator\"></P-breadcrumb>\n          <router-view  @on-setOpenMenu=\"setOpenMenu\" ></router-view>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport Cookies from 'js-cookie';\nimport _ from 'lodash';\nimport { http, resourceConf } from '../../utils/';\nimport { TopMenu, ShrinkableMenu, FullScreen, ThemeSwitch, PBreadcrumb } from '@bairong/jax-core';\nimport userMenu from './common/userMenu';\n\nexport default {\n  name: 'Layout',\n  components: {\n    ShrinkableMenu,\n    FullScreen,\n    ThemeSwitch,\n    TopMenu,\n    PBreadcrumb,\n    userMenu\n  },\n  props: {\n    isOpenDefautlMenu: {\n      type: Boolean,\n      default: true\n    },\n    headerTitle: {\n      type: String,\n      default: ''\n    },\n    showFullScreen: {\n      type: Boolean,\n      default: false\n    },\n    showThemeSwitch: {\n      type: Boolean,\n      default: false\n    },\n    changeTopMenu: {\n      type: Function\n    },\n    iconSize: {\n      Number,\n      default: 18\n    },\n    showSubIcon: {\n      type: Boolean,\n      default: true\n    },\n    separator: {\n      type: String\n    },\n    beadcrumbException: {\n      type: Array,\n      default: () => {\n        return ['/home', '/404'];\n      }\n    }\n  },\n  data () {\n    return {\n      shrink: !!+Cookies.set('isShrink'),\n      isFullScreen: false,\n      openedSubmenuArr: [],\n      activeName: '',\n      saveLoading: false,\n      resourceConf\n    };\n  },\n  computed: {\n    menuList () {\n      if ( this.isOpenDefautlMenu && this.$store.state.user.sideList.length) {\n        this.openDefaultMenu();\n      }\n      return this.$store.state.user.sideList;\n    },\n    toolbarList () {\n      return this.$store.state.user.toolbarList;\n    },\n    toolbarActiveName () {\n      const toolbarList = this.$store.state.user.toolbarList;\n      const activeMenu = toolbarList.filter(item => !!item.className) || [];\n      return activeMenu.length ? activeMenu[0].name : '';\n    },\n    /**\n     * 取得一级目录展开名称，\n     * return Array\n     * */\n    getOpenMenuNames () {\n      const names = _.map(this.$route.path.split('/')).filter(path => path !== '') || '';\n      return ['/' + names[0]] || this.openedSubmenuArr;\n    },\n    /**\n     * 取得当前二级菜单\n     * */\n    getActiveName () {\n      const parentPath = this.$route.meta.parentPath;\n      return parentPath || this.activeName || this.$route.path;\n    },\n    menuTheme () {\n      return this.$store.state.app.menuTheme;\n    },\n    isShowBeadcrumb () {\n      const { name, path } = this.$route;\n      return this.beadcrumbException.indexOf('/' + name) > -1 || this.beadcrumbException.indexOf(path) > -1;\n    },\n    isShowTitle () {\n      return this.headerTitle !== '';\n    },\n    isDark () {\n      return this.$store.state.app.menuTheme === 'dark';\n    }\n  },\n  methods: {\n    init () {\n      // let openMenuName = this.$route.name;\n      // this.openedSubmenuArr = [openMenuName];\n      //  let pathArr = regExp.setCurrentPath(this, this.$route.name);\n      //  this.$store.commit('updateMenulist');\n      //  if (pathArr.length >= 2) {\n      //    this.$store.commit('addOpenSubmenu', pathArr[1].name);\n      //  }\n      // this.userName = Cookies.get('user');\n    },\n    cookieExtend () {\n      return http.DOMAIN.includes('100credit.com') ? [{ path: '/', domain: '100credit.com' }] : [];\n    },\n    toggleClick () {\n      this.shrink = !this.shrink;\n      Cookies.set(...['isShrink', this.shrink ? 1 : 0].concat(this.cookieExtend()));\n    },\n    handleSubmenuChange (val) {\n      this.activeName = val;\n    },\n    fullscreenChange (isFullScreen) {\n    },\n    handleChangeTopMenu ({ id, url }) {\n      this.$router.push({ path: url });\n      this.$emit('on-changeTopMenu', id);\n      this.activeName = url;\n    },\n    /**\n     * 首次打开时，显示home，再刷新显示默认第一个菜单\n     * */\n    openDefaultMenu () {\n      let menuList = this.$store.state.user.sideList;\n      let defaultMenu = menuList[0].children && menuList[0].children.length ? menuList[0].children[0].path : menuList[0].path;\n      let hashName = this.$route.name;\n      let noOpenDefautlMenu = +Cookies.get('NOODM') || 0;\n      if (hashName === 'home' && !noOpenDefautlMenu) {\n        this.$router.push({ path: defaultMenu });\n      }\n      Cookies.remove(...['NOODM'].concat(this.cookieExtend()));\n    },\n    /**\n     * 手动设置展开一级目录,当前二级菜单\n     * @param data{}\n     * */\n    setOpenMenu (data) {\n      this.openedSubmenuArr = [data.openMenuName];\n      this.activeName = data.activeName;\n    }\n  },\n  mounted () {\n    this.init();\n  }\n};\n</script>\n"]}]}